#
# MPX Trackinfo
# (C) 2008 M. Derezynski
#

import mpx
import mpx_playlist
import time
#import pygtk
#pygtk.require('2.0')
#import gtk
#import gtk.glade
#import pango
#import musicbrainz2
#import musicbrainz2.webservice as ws

class MPXDJ(mpx_playlist.PlaylistPlugin):
	def __init__(self):
		print ">> MPXDJ Plugin initialized (C) 2008 M. Derezynski"
		self.gladedir = "@DATA_DIR@" + "/glade/mpxdj.glade"

	def prepare(self,lib):
		print ">> MPXDJ Plugin preparing"

	def run(self,lib,v):
		print ">> MPXDJ Running"
		rv = mpx.SQLRowV()
		t = time.time()
		t = t - 2419200
		lib.getSQL(rv, "SELECT id FROM track_view WHERE abs_rating(rating,album_rating) > 22 AND pdate > " + str(t));
		for val in rv:
			v.append(val["id"].get_int())


